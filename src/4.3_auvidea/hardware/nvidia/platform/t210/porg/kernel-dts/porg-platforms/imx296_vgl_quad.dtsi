/*
 * Copyright (c) 2018-2019, NVIDIA CORPORATION.  All rights reserved.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
 * more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#define BUS_WIDTH 1 
#define NUM_LANES "1"
#define NUM_CSI_LANES 8 

//#define USE_SENSOR_MODE_ID  "false"     /* CCC - use_sensor_mode_id value */
#define USE_SENSOR_MODE_ID  "true"      /* CCC - use_sensor_mode_id value   */

//#define EXPOSURE_FACTOR     "1000000"   /* CCC - exposure factor            */
#define EXPOSURE_FACTOR     "1"         /* CCC - exposure factor            */

#include <dt-bindings/media/camera.h>
#include <dt-bindings/platform/t210/t210.h>

/ {
    host1x {
        imx296_vgl_vi_base: vi {
			status="okay";
            num-channels = <4>;
            ports {
                status = "okay";
                imx296_vgl_vi_port0: port@0 {
                    status = "okay";
                    reg = <0>;
                    rbpcv2_imx296_vgl_vi_in0: endpoint {
                        status = "okay";
                        port-index = <0>;
                        bus-width = <BUS_WIDTH>;
                        remote-endpoint = <&rbpcv2_imx296_vgl_csi_out0>;
                    };
                };
 
                imx296_vgl_vi_port1: port@1 {
                    status = "okay";
                    reg = <1>;
                    rbpcv2_imx296_vgl_vi_in1: endpoint {
                        status = "okay";
                        port-index = <2>;
                        bus-width = <BUS_WIDTH>;
                        remote-endpoint = <&rbpcv2_imx296_vgl_csi_out1>;
                    };
                };

                imx296_vgl_vi_port2: port@2 {
                    status = "okay";
                    reg = <2>;
                    rbpcv2_imx296_vgl_vi_in2: endpoint {
                        status = "okay";
                        port-index = <4>;
                        bus-width = <BUS_WIDTH>;
                        remote-endpoint = <&rbpcv2_imx296_vgl_csi_out2>;
                    };
                };

                imx296_vgl_vi_port3: port@3 {
                    status = "okay";
                    reg = <3>;
                    rbpcv2_imx296_vgl_vi_in3: endpoint {
                        status = "okay";
                        port-index = <6>;
                        bus-width = <BUS_WIDTH>;
                        remote-endpoint = <&rbpcv2_imx296_vgl_csi_out3>;
                    };
                };
            };
        };

        imx296_vgl_csi_base: nvcsi {
			status="okay";
            num-channels = <4>;
            imx296_vgl_csi_chan0: channel@0 {
                status = "okay";
                reg = <0>;
                ports {
                    status = "okay";
                    #address-cells = <1>;
                    #size-cells = <0>;
                    imx296_vgl_csi_chan0_port0: port@0 {
                        reg = <0>;
                        rbpcv2_imx296_vgl_csi_in0: endpoint@0 {
                            port-index = <0>;
                            bus-width = <BUS_WIDTH>;
                            remote-endpoint = <&rbpcv2_imx296_vgl_out0>;
                        };
                    };
 
                    imx296_vgl_csi_chan0_port1: port@1 {
                        reg = <1>;
                        rbpcv2_imx296_vgl_csi_out0: endpoint@1 {
                            remote-endpoint = <&rbpcv2_imx296_vgl_vi_in0>;
                        };
                    };
                };
            };

            imx296_vgl_csi_chan1: channel@1 {
                reg = <1>;
                ports {
                    status = "okay";
                    #address-cells = <1>;
                    #size-cells = <0>;
                    imx296_vgl_csi_chan1_port0: port@2 {
                        reg = <0>;
                        rbpcv2_imx296_vgl_csi_in1: endpoint@2 {
                            port-index = <2>;
                            bus-width = <BUS_WIDTH>;
                            remote-endpoint = <&rbpcv2_imx296_vgl_out1>;
                        };
                    };
                    imx296_vgl_csi_chan1_port1: port@3 {
                        reg = <1>;
                        rbpcv2_imx296_vgl_csi_out1: endpoint@3 {
                            remote-endpoint = <&rbpcv2_imx296_vgl_vi_in1>;
                        };
                    };
                };
            };
 
            imx296_vgl_csi_chan2: channel@2 {
                reg = <2>;
                ports {
                    status = "okay";
                    #address-cells = <1>;
                    #size-cells = <0>;
                    imx296_vgl_csi_chan2_port0: port@4 {
                        reg = <0>;
                        rbpcv2_imx296_vgl_csi_in2: endpoint@4 {
                            port-index = <4>;
                            bus-width = <BUS_WIDTH>;
                            remote-endpoint = <&rbpcv2_imx296_vgl_out2>;
                        };
                    };
                    imx296_vgl_csi_chan2_port1: port@5 {
                        reg = <1>;
                        rbpcv2_imx296_vgl_csi_out2: endpoint@5 {
                            remote-endpoint = <&rbpcv2_imx296_vgl_vi_in2>;
                        };
                    };
                };
            };
 
            imx296_vgl_csi_chan3: channel@3 {
                reg = <3>;
                ports {
                    status = "okay";
                    #address-cells = <1>;
                    #size-cells = <0>;
                    imx296_vgl_csi_chan3_port0: port@6 {
                        reg = <0>;
                        rbpcv2_imx296_vgl_csi_in3: endpoint@6 {
                            port-index = <6>;
                            bus-width = <BUS_WIDTH>;
                            remote-endpoint = <&rbpcv2_imx296_vgl_out3>;
                        };
                    };
                    imx296_vgl_csi_chan3_port1: port@7 {
                        reg = <1>;
                        rbpcv2_imx296_vgl_csi_out3: endpoint@7 {
                            remote-endpoint = <&rbpcv2_imx296_vgl_vi_in3>;
                        };
                    };
                };
            };
        };

        imx296_vgl_i2c_0: i2c@546c0000 {
            imx296_vgl_cam0: rbpcv2_imx296_vgl_a@1a {
                compatible = "nvidia,imx296_vgl";
                /* I2C device address */
                reg = <0x1a>;
 
                /* V4L2 device node location */
                devnode = "video0";
 
                /* Physical dimensions of sensor */
                physical_w = "3.680";
                physical_h = "2.760";
 
                sensor_model = "imx296";
 
                flash-output = "1";
                use_sensor_mode_id = USE_SENSOR_MODE_ID;  // "false"; "true";
 
                mode0 { // IMX296_MODE_1440X1080, 60 FPS, color
                    mclk_khz = "24000";
                    num_lanes = NUM_LANES;
                    tegra_sinterface = "serial_a";
                    phy_mode = "DPHY";
                    discontinuous_clk = "no"; // "yes";
                    dpcm_enable = "false";
                    cil_settletime = "0";
 
                    active_w = "1440";
                    active_h = "1080";
                    pixel_t = "bayer_rggb";
 
                    readout_orientation = "0";
                    line_length = "1568";
                    inherent_gain = "1";
                    mclk_multiplier = "9.33";
                    pix_clk_hz = "482400000";
 
                    gain_factor = "16";
                    framerate_factor = "1000000";
                    exposure_factor = EXPOSURE_FACTOR;
                    min_gain_val = "0";   /* 1.00x */
                    max_gain_val = "480"; /* 10.66x */
                    step_gain_val = "1";
                    default_gain = "20";   /* 1.00x */
                    min_hdr_ratio = "1";
                    max_hdr_ratio = "1";
                    min_framerate = "10000000"; /* 10.0 fps */
                    max_framerate = "60000000"; /* 60.0 fps */
                    step_framerate = "1";
                    default_framerate = "30000000"; /* 30.0 fps */
                    min_exp_time = "29";       /* us */
                    max_exp_time = "15110711"; /* us */
                    step_exp_time = "1";
                    default_exp_time = "2000"; /* us */
 
                    embedded_metadata_height = "0";   // 219: "2"
                };
 
                mode1 { // IMX296_MODE_1440X1080, 60 FPS, trigger mode
                    mclk_khz = "24000";
                    num_lanes = NUM_LANES;
                    tegra_sinterface = "serial_a";
                    phy_mode = "DPHY";
                    discontinuous_clk = "no"; // "yes";
                    dpcm_enable = "false";
                    cil_settletime = "0";
 
                    active_w = "1440";
                    active_h = "1080";
                    pixel_t = "bayer_rggb";
                    // pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                    readout_orientation = "0";
                    line_length = "1568";
                    inherent_gain = "1";
                    mclk_multiplier = "9.33";
                    pix_clk_hz = "482400000";
 
                    gain_factor = "16";
                    framerate_factor = "1000000";
                    exposure_factor = EXPOSURE_FACTOR;
                    min_gain_val = "0";   /* 1.00x */
                    max_gain_val = "480"; /* 10.66x */
                    step_gain_val = "1";
                    default_gain = "20";   /* 1.00x */
                    min_hdr_ratio = "1";
                    max_hdr_ratio = "1";
                    min_framerate = "10000000"; /* 10.0 fps */
                    max_framerate = "60000000"; /* 60.0 fps */
                    step_framerate = "1";
                    default_framerate = "30000000"; /* 30.0 fps */
                    min_exp_time = "29";       /* us */
                    max_exp_time = "15110711"; /* us */
                    step_exp_time = "1";
                    default_exp_time = "2000"; /* us */
 
                    embedded_metadata_height = "0";   // 219: "2"
                };
 
                mode2 { // IMX296_MODE_1440X1080, 60 FPS, grayscale
                    mclk_khz = "24000";
                    num_lanes = NUM_LANES;
                    tegra_sinterface = "serial_a";
                    phy_mode = "DPHY";
                    discontinuous_clk = "no"; // "yes";
                    dpcm_enable = "false";
                    cil_settletime = "0";
 
                    active_w = "1440";
                    active_h = "1080";
                    // pixel_t = "bayer_rggb";
                    pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                    readout_orientation = "0";
                    line_length = "1568";
                    inherent_gain = "1";
                    mclk_multiplier = "9.33";
                    pix_clk_hz = "482400000";
 
                    gain_factor = "16";
                    framerate_factor = "1000000";
                    exposure_factor = EXPOSURE_FACTOR;
                    min_gain_val = "0";   /* 1.00x */
                    max_gain_val = "480"; /* 10.66x */
                    step_gain_val = "1";
                    default_gain = "20";   /* 1.00x */
                    min_hdr_ratio = "1";
                    max_hdr_ratio = "1";
                    min_framerate = "10000000"; /* 10.0 fps */
                    max_framerate = "60000000"; /* 60.0 fps */
                    step_framerate = "1";
                    default_framerate = "30000000"; /* 30.0 fps */
                    min_exp_time = "29";       /* us */
                    max_exp_time = "15110711"; /* us */
                    step_exp_time = "1";
                    default_exp_time = "2000"; /* us */
 
                    embedded_metadata_height = "0";   // 219: "2"
                };
 
                ports {
                    #address-cells = <1>;
                    #size-cells = <0>;
 
                    port@0 {
                        reg = <0>;
                        rbpcv2_imx296_vgl_out0: endpoint {
							port-index = <0>;
							bus-width = <BUS_WIDTH>;
                            remote-endpoint = <&rbpcv2_imx296_vgl_csi_in0>;
                        };
                    };
                };
            };
        };

        imx296_vgl_i2c_1: i2c@7000c000 {
            imx296_vgl_cam1: rbpcv2_imx296_vgl_c@1a {
                compatible = "nvidia,imx296_vgl";
                /* I2C device address */
                reg = <0x1a>;
 
                /* V4L2 device node location */
                devnode = "video1";
 
                /* Physical dimensions of sensor */
                physical_w = "3.680";
                physical_h = "2.760";
 
                sensor_model = "imx296";
 
                flash-output = "1";
                use_sensor_mode_id = USE_SENSOR_MODE_ID;  // "false"; "true";
 
                mode0 { // IMX296_MODE_1440X1080, 60 FPS, color
                    mclk_khz = "24000";
                    num_lanes = NUM_LANES;
                    tegra_sinterface = "serial_c";
                    phy_mode = "DPHY";
                    discontinuous_clk = "no"; // "yes";
                    dpcm_enable = "false";
                    cil_settletime = "0";
 
                    active_w = "1440";
                    active_h = "1080";
                    pixel_t = "bayer_rggb";
 
                    readout_orientation = "0";
                    line_length = "1568";
                    inherent_gain = "1";
                    mclk_multiplier = "9.33";
                    pix_clk_hz = "482400000";
 
                    gain_factor = "16";
                    framerate_factor = "1000000";
                    exposure_factor = EXPOSURE_FACTOR;
                    min_gain_val = "0";   /* 1.00x */
                    max_gain_val = "480"; /* 10.66x */
                    step_gain_val = "1";
                    default_gain = "20";   /* 1.00x */
                    min_hdr_ratio = "1";
                    max_hdr_ratio = "1";
                    min_framerate = "10000000"; /* 10.0 fps */
                    max_framerate = "60000000"; /* 60.0 fps */
                    step_framerate = "1";
                    default_framerate = "30000000"; /* 30.0 fps */
                    min_exp_time = "29";       /* us */
                    max_exp_time = "15110711"; /* us */
                    step_exp_time = "1";
                    default_exp_time = "2000"; /* us */
 
                    embedded_metadata_height = "0";   // 219: "2"
                };
 
                mode1 { // IMX296_MODE_1440X1080, 60 FPS, trigger mode
                    mclk_khz = "24000";
                    num_lanes = NUM_LANES;
                    tegra_sinterface = "serial_c";
                    phy_mode = "DPHY";
                    discontinuous_clk = "no"; // "yes";
                    dpcm_enable = "false";
                    cil_settletime = "0";
 
                    active_w = "1440";
                    active_h = "1080";
                    pixel_t = "bayer_rggb";
                    // pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                    readout_orientation = "0";
                    line_length = "1568";
                    inherent_gain = "1";
                    mclk_multiplier = "9.33";
                    pix_clk_hz = "482400000";
 
                    gain_factor = "16";
                    framerate_factor = "1000000";
                    exposure_factor = EXPOSURE_FACTOR;
                    min_gain_val = "0";   /* 1.00x */
                    max_gain_val = "480"; /* 10.66x */
                    step_gain_val = "1";
                    default_gain = "20";   /* 1.00x */
                    min_hdr_ratio = "1";
                    max_hdr_ratio = "1";
                    min_framerate = "10000000"; /* 10.0 fps */
                    max_framerate = "60000000"; /* 60.0 fps */
                    step_framerate = "1";
                    default_framerate = "30000000"; /* 30.0 fps */
                    min_exp_time = "29";       /* us */
                    max_exp_time = "15110711"; /* us */
                    step_exp_time = "1";
                    default_exp_time = "2000"; /* us */
 
                    embedded_metadata_height = "0";   // 219: "2"
                };
 
                mode2 { // IMX296_MODE_1440X1080, 60 FPS, grayscale
                    mclk_khz = "24000";
                    num_lanes = NUM_LANES;
                    tegra_sinterface = "serial_c";
                    phy_mode = "DPHY";
                    discontinuous_clk = "no"; // "yes";
                    dpcm_enable = "false";
                    cil_settletime = "0";
 
                    active_w = "1440";
                    active_h = "1080";
                    // pixel_t = "bayer_rggb";
                    pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                    readout_orientation = "0";
                    line_length = "1568";
                    inherent_gain = "1";
                    mclk_multiplier = "9.33";
                    pix_clk_hz = "482400000";
 
                    gain_factor = "16";
                    framerate_factor = "1000000";
                    exposure_factor = EXPOSURE_FACTOR;
                    min_gain_val = "0";   /* 1.00x */
                    max_gain_val = "480"; /* 10.66x */
                    step_gain_val = "1";
                    default_gain = "20";   /* 1.00x */
                    min_hdr_ratio = "1";
                    max_hdr_ratio = "1";
                    min_framerate = "10000000"; /* 10.0 fps */
                    max_framerate = "60000000"; /* 60.0 fps */
                    step_framerate = "1";
                    default_framerate = "30000000"; /* 30.0 fps */
                    min_exp_time = "29";       /* us */
                    max_exp_time = "15110711"; /* us */
                    step_exp_time = "1";
                    default_exp_time = "2000"; /* us */
 
                    embedded_metadata_height = "0";   // 219: "2"
                };
 
                ports {
                    #address-cells = <1>;
                    #size-cells = <0>;
 
                    port@0 {
                        reg = <0>;
                        rbpcv2_imx296_vgl_out1: endpoint {
							port-index = <2>;
							bus-width = <BUS_WIDTH>;
                            remote-endpoint = <&rbpcv2_imx296_vgl_csi_in1>;
                        };
                    };
                };
            };
        };
    };
 
    imx296_vgl_i2c_2: i2c@7000c400 {
        imx296_vgl_cam2: rbpcv2_imx296_vgl_e@1a {
            compatible = "nvidia,imx296_vgl";
            /* I2C device address */
            reg = <0x1a>;
 
            /* V4L2 device node location */
            devnode = "video2";
 
            /* Physical dimensions of sensor */
            physical_w = "3.680";
            physical_h = "2.760";
 
            sensor_model = "imx296";
 
            flash-output = "1";
            use_sensor_mode_id = USE_SENSOR_MODE_ID;  // "false"; "true";

            mode0 { // IMX296_MODE_1440X1080, 60 FPS, color
                mclk_khz = "24000";
                num_lanes = NUM_LANES;
                tegra_sinterface = "serial_e";
                phy_mode = "DPHY";
                discontinuous_clk = "no"; // "yes";
                dpcm_enable = "false";
                cil_settletime = "0";
 
                active_w = "1440";
                active_h = "1080";
                pixel_t = "bayer_rggb";
 
                readout_orientation = "0";
                line_length = "1568";
                inherent_gain = "1";
                mclk_multiplier = "9.33";
                pix_clk_hz = "482400000";
 
                gain_factor = "16";
                framerate_factor = "1000000";
                exposure_factor = EXPOSURE_FACTOR;
                min_gain_val = "0";   /* 1.00x */
                max_gain_val = "480"; /* 10.66x */
                step_gain_val = "1";
                default_gain = "20";   /* 1.00x */
                min_hdr_ratio = "1";
                max_hdr_ratio = "1";
                min_framerate = "10000000"; /* 10.0 fps */
                max_framerate = "60000000"; /* 60.0 fps */
                step_framerate = "1";
                default_framerate = "30000000"; /* 30.0 fps */
                min_exp_time = "29";       /* us */
                max_exp_time = "15110711"; /* us */
                step_exp_time = "1";
                default_exp_time = "2000"; /* us */
 
                embedded_metadata_height = "0";   // 219: "2"
            };
 
            mode1 { // IMX296_MODE_1440X1080, 60 FPS, trigger mode
                mclk_khz = "24000";
                num_lanes = NUM_LANES;
                tegra_sinterface = "serial_e";
                phy_mode = "DPHY";
                discontinuous_clk = "no"; // "yes";
                dpcm_enable = "false";
                cil_settletime = "0";
 
                active_w = "1440";
                active_h = "1080";
                pixel_t = "bayer_rggb";
                // pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                readout_orientation = "0";
                line_length = "1568";
                inherent_gain = "1";
                mclk_multiplier = "9.33";
                pix_clk_hz = "482400000";
 
                gain_factor = "16";
                framerate_factor = "1000000";
                exposure_factor = EXPOSURE_FACTOR;
                min_gain_val = "0";   /* 1.00x */
                max_gain_val = "480"; /* 10.66x */
                step_gain_val = "1";
                default_gain = "20";   /* 1.00x */
                min_hdr_ratio = "1";
                max_hdr_ratio = "1";
                min_framerate = "10000000"; /* 10.0 fps */
                max_framerate = "60000000"; /* 60.0 fps */
                step_framerate = "1";
                default_framerate = "30000000"; /* 30.0 fps */
                min_exp_time = "29";       /* us */
                max_exp_time = "15110711"; /* us */
                step_exp_time = "1";
                default_exp_time = "2000"; /* us */
 
                embedded_metadata_height = "0";   // 219: "2"
            };
 
            mode2 { // IMX296_MODE_1440X1080, 60 FPS, grayscale
                mclk_khz = "24000";
                num_lanes = NUM_LANES;
                tegra_sinterface = "serial_e";
                phy_mode = "DPHY";
                discontinuous_clk = "no"; // "yes";
                dpcm_enable = "false";
                cil_settletime = "0";
 
                active_w = "1440";
                active_h = "1080";
                // pixel_t = "bayer_rggb";
                pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                readout_orientation = "0";
                line_length = "1568";
                inherent_gain = "1";
                mclk_multiplier = "9.33";
                pix_clk_hz = "482400000";
 
                gain_factor = "16";
                framerate_factor = "1000000";
                exposure_factor = EXPOSURE_FACTOR;
                min_gain_val = "0";   /* 1.00x */
                max_gain_val = "480"; /* 10.66x */
                step_gain_val = "1";
                default_gain = "20";   /* 1.00x */
                min_hdr_ratio = "1";
                max_hdr_ratio = "1";
                min_framerate = "10000000"; /* 10.0 fps */
                max_framerate = "60000000"; /* 60.0 fps */
                step_framerate = "1";
                default_framerate = "30000000"; /* 30.0 fps */
                min_exp_time = "29";       /* us */
                max_exp_time = "15110711"; /* us */
                step_exp_time = "1";
                default_exp_time = "2000"; /* us */
 
                embedded_metadata_height = "0";   // 219: "2"
            };
 
            ports {
                #address-cells = <1>;
                #size-cells = <0>;
 
                port@0 {
                    reg = <0>;
                    rbpcv2_imx296_vgl_out2: endpoint {
						port-index = <4>;
						bus-width = <BUS_WIDTH>;
                        remote-endpoint = <&rbpcv2_imx296_vgl_csi_in2>;
                    };
                };
            };
        };
    };
 
    imx296_vgl_i2c_3: i2c@7000c500 {
        imx296_vgl_cam3: rbpcv2_imx296_vgl_f@1a {
            compatible = "nvidia,imx296_vgl";
            /* I2C device address */
            reg = <0x1a>;
 
            /* V4L2 device node location */
            devnode = "video3";
 
            /* Physical dimensions of sensor */
            physical_w = "3.680";
            physical_h = "2.760";
 
            sensor_model = "imx296";
 
            flash-output = "1";
            use_sensor_mode_id = USE_SENSOR_MODE_ID;  // "false"; "true";

            mode0 { // IMX296_MODE_1440X1080, 60 FPS, color
                mclk_khz = "24000";
                num_lanes = NUM_LANES;
                tegra_sinterface = "serial_f";
                phy_mode = "DPHY";
                discontinuous_clk = "no"; // "yes";
                dpcm_enable = "false";
                cil_settletime = "0";
 
                active_w = "1440";
                active_h = "1080";
                pixel_t = "bayer_rggb";
 
                readout_orientation = "0";
                line_length = "1568";
                inherent_gain = "1";
                mclk_multiplier = "9.33";
                pix_clk_hz = "482400000";
 
                gain_factor = "16";
                framerate_factor = "1000000";
                exposure_factor = EXPOSURE_FACTOR;
                min_gain_val = "0";   /* 1.00x */
                max_gain_val = "480"; /* 10.66x */
                step_gain_val = "1";
                default_gain = "20";   /* 1.00x */
                min_hdr_ratio = "1";
                max_hdr_ratio = "1";
                min_framerate = "10000000"; /* 10.0 fps */
                max_framerate = "60000000"; /* 60.0 fps */
                step_framerate = "1";
                default_framerate = "30000000"; /* 30.0 fps */
                min_exp_time = "29";       /* us */
                max_exp_time = "15110711"; /* us */
                step_exp_time = "1";
                default_exp_time = "2000"; /* us */
 
                embedded_metadata_height = "0";   // 219: "2"
            };
 
            mode1 { // IMX296_MODE_1440X1080, 60 FPS, trigger mode
                mclk_khz = "24000";
                num_lanes = NUM_LANES;
                tegra_sinterface = "serial_f";
                phy_mode = "DPHY";
                discontinuous_clk = "no"; // "yes";
                dpcm_enable = "false";
                cil_settletime = "0";
 
                active_w = "1440";
                active_h = "1080";
                pixel_t = "bayer_rggb";
                // pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                readout_orientation = "0";
                line_length = "1568";
                inherent_gain = "1";
                mclk_multiplier = "9.33";
                pix_clk_hz = "482400000";
 
                gain_factor = "16";
                framerate_factor = "1000000";
                exposure_factor = EXPOSURE_FACTOR;
                min_gain_val = "0";   /* 1.00x */
                max_gain_val = "480"; /* 10.66x */
                step_gain_val = "1";
                default_gain = "20";   /* 1.00x */
                min_hdr_ratio = "1";
                max_hdr_ratio = "1";
                min_framerate = "10000000"; /* 10.0 fps */
                max_framerate = "60000000"; /* 60.0 fps */
                step_framerate = "1";
                default_framerate = "30000000"; /* 30.0 fps */
                min_exp_time = "29";       /* us */
                max_exp_time = "15110711"; /* us */
                step_exp_time = "1";
                default_exp_time = "2000"; /* us */
 
                embedded_metadata_height = "0";   // 219: "2"
            };
 
            mode2 { // IMX296_MODE_1440X1080, 60 FPS, grayscale
                mclk_khz = "24000";
                num_lanes = NUM_LANES;
                tegra_sinterface = "serial_f";
                phy_mode = "DPHY";
                discontinuous_clk = "no"; // "yes";
                dpcm_enable = "false";
                cil_settletime = "0";
 
                active_w = "1440";
                active_h = "1080";
                // pixel_t = "bayer_rggb";
                pixel_t = "y10";            // V4L2_PIX_FMT_Y10 = 'Y10 '
 
                readout_orientation = "0";
                line_length = "1568";
                inherent_gain = "1";
                mclk_multiplier = "9.33";
                pix_clk_hz = "482400000";
 
                gain_factor = "16";
                framerate_factor = "1000000";
                exposure_factor = EXPOSURE_FACTOR;
                min_gain_val = "0";   /* 1.00x */
                max_gain_val = "480"; /* 10.66x */
                step_gain_val = "1";
                default_gain = "20";   /* 1.00x */
                min_hdr_ratio = "1";
                max_hdr_ratio = "1";
                min_framerate = "10000000"; /* 10.0 fps */
                max_framerate = "60000000"; /* 60.0 fps */
                step_framerate = "1";
                default_framerate = "30000000"; /* 30.0 fps */
                min_exp_time = "29";       /* us */
                max_exp_time = "15110711"; /* us */
                step_exp_time = "1";
                default_exp_time = "2000"; /* us */
 
                embedded_metadata_height = "0";   // 219: "2"
            };
 
            ports {
                #address-cells = <1>;
                #size-cells = <0>;
 
                port@0 {
                    reg = <0>;
                    rbpcv2_imx296_vgl_out3: endpoint {
						port-index = <6>;
						bus-width = <BUS_WIDTH>;
                        remote-endpoint = <&rbpcv2_imx296_vgl_csi_in3>;
                    };
                };
            };
        };
    };

    lens_imx296_vgl@RBPCV2 {
        min_focus_distance = "0.0";
        hyper_focal = "0.0";
        focal_length = "3.04";
        f_number = "2.0";
        aperture = "0.0";
    };
};

/ {
    imx296_vgl_tcp: tegra-camera-platform {
        compatible = "nvidia, tegra-camera-platform";

        /**
        * Physical settings to calculate max ISO BW
        *
        * num_csi_lanes = <>;
        * Total number of CSI lanes when all cameras are active
        *
        * max_lane_speed = <>;
        * Max lane speed in Kbit/s
        *
        * min_bits_per_pixel = <>;
        * Min bits per pixel
        *
        * vi_peak_byte_per_pixel = <>;
        * Max byte per pixel for the VI ISO case
        *
        * vi_bw_margin_pct = <>;
        * Vi bandwidth margin in percentage
        *
        * max_pixel_rate = <>;
        * Max pixel rate in Kpixel/s for the ISP ISO case
        *
        * isp_peak_byte_per_pixel = <>;
        * Max byte per pixel for the ISP ISO case
        *
        * isp_bw_margin_pct = <>;
        * Isp bandwidth margin in percentage
        */
        num_csi_lanes = <NUM_CSI_LANES>;
        max_lane_speed = <1500000>;
        min_bits_per_pixel = <10>;
        vi_peak_byte_per_pixel = <2>;
        vi_bw_margin_pct = <25>;
        max_pixel_rate = <240000>;
        isp_peak_byte_per_pixel = <5>;
        isp_bw_margin_pct = <25>;

        /**
         * The general guideline for naming badge_info contains 3 parts, and is as follows,
         * The first part is the camera_board_id for the module; if the module is in a FFD
         * platform, then use the platform name for this part.
         * The second part contains the position of the module, ex. "rear" or "front".
         * The third part contains the last 6 characters of a part number which is found
         * in the module's specsheet from the vendor.
         */
         
/*
Jetson Nano dual-port I2C busses:
aliases {
    i2c0 = "/host1x/i2c@7000c000";
    i2c1 = "/i2c@7000c400";
    i2c2 = "/i2c@7000c500";
    i2c3 = "/i2c@7000c700";
    i2c4 = "/i2c@7000d000";
    i2c5 = "/i2c@7000d100";
    i2c6 = "/host1x/i2c@546c0000";
};
*/
        modules {
			status="okay";
            imx296_vgl_cam_module0: module0 {
                status = "okay";
                badge = "porg_topleft_RBPCV2";
                position = "topleft";
                orientation = "1";
                imx296_vgl_cam_module0_drivernode0: drivernode0 {
                    status = "okay";
                    pcl_id = "v4l2_sensor";
                    devname = "imx296_vgl 6-001a";
                    proc-device-tree = "/proc/device-tree/host1x/i2c@546c0000/rbpcv2_imx296_vgl_a@1a";
                };
                imx296_vgl_cam_module0_drivernode1: drivernode1 {
                    status = "okay";
                    pcl_id = "v4l2_lens";
                    proc-device-tree = "/proc/device-tree/lens_imx296_vgl@RBPCV2/";
                };
            };

            imx296_vgl_cam_module1: module1 {
                status = "okay";
                badge = "porg_topright_RBPCV2";
                position = "topright";
                orientation = "1";
                imx296_vgl_cam_module1_drivernode0: drivernode0 {
                    status = "okay";
                    pcl_id = "v4l2_sensor";
                    devname = "imx296_vgl 0-001a";
                    proc-device-tree = "/proc/device-tree/host1x/i2c@7000c000/rbpcv2_imx296_vgl_c@1a";
                };
                imx296_vgl_cam_module1_drivernode1: drivernode1 {
                    status = "okay";
                    pcl_id = "v4l2_lens";
                    proc-device-tree = "/proc/device-tree/lens_imx296_vgl@RBPCV2/";
                };
            };

            imx296_vgl_cam_module2: module2 {
                status = "okay";
                badge = "porg_bottomleft_RBPCV2";
                position = "bottomleft";
                orientation = "1";
                imx296_vgl_cam_module2_drivernode0: drivernode0 {
                    status = "okay";
                    pcl_id = "v4l2_sensor";
                    devname = "imx296_vgl 1-001a";
                    proc-device-tree = "/proc/device-tree/i2c@7000c400/rbpcv2_imx296_vgl_e@1a";
                };
                imx296_vgl_cam_module2_drivernode1: drivernode1 {
                    status = "okay";
                    pcl_id = "v4l2_lens";
                    proc-device-tree = "/proc/device-tree/lens_imx296_vgl@RBPCV2/";
                };
            };

            imx296_vgl_cam_module3: module3 {
                status = "okay";
                badge = "porg_bottomright_RBPCV2";
                position = "bottomright";
                orientation = "1";
                imx296_vgl_cam_module3_drivernode0: drivernode0 {
                    status = "okay";
                    pcl_id = "v4l2_sensor";
                    devname = "imx296_vgl 2-001a";
                    proc-device-tree = "/proc/device-tree/i2c@7000c500/rbpcv2_imx296_vgl_f@1a";
                };
                imx296_vgl_cam_module3_drivernode1: drivernode1 {
                    status = "okay";
                    pcl_id = "v4l2_lens";
                    proc-device-tree = "/proc/device-tree/lens_imx296_vgl@RBPCV2/";
                };
            };
        };
    };
};

#define CAM1_PWDN       TEGRA_GPIO(S, 7)
#define CAM2_PWDN       TEGRA_GPIO(T, 0)
#define CAM3_PWDN		TEGRA_GPIO(S, 5)
#define CAM4_PWDN		TEGRA_GPIO(T, 1)
#define CAM_TRIGGER		TEGRA_GPIO(V, 0)

/ {
    host1x {
        i2c@546c0000 {
            status = "okay";
            #address-cells = <1>;
            #size-cells = <0>;
            rbpcv2_imx296_vgl_a@1a {
                status = "okay";
                reset-gpios = <&gpio CAM1_PWDN GPIO_ACTIVE_HIGH>;
            };
        };
        i2c@7000c000 {
            status = "okay";
            #address-cells = <1>;
            #size-cells = <0>;
            rbpcv2_imx296_vgl_c@1a {
                status = "okay";
                reset-gpios = <&gpio CAM2_PWDN GPIO_ACTIVE_HIGH>;
            };
        };
    };

    i2c@7000c400 {
        status = "okay";
        #address-cells = <1>;
        #size-cells = <0>;
        rbpcv2_imx296_vgl_e@1a {
            status = "okay";
            reset-gpios = <&gpio CAM3_PWDN GPIO_ACTIVE_HIGH>;
        };
    };

    i2c@7000c500 {
        status = "okay";
        #address-cells = <1>;
        #size-cells = <0>;
        rbpcv2_imx296_vgl_f@1a {
            status = "okay";
            reset-gpios = <&gpio CAM4_PWDN GPIO_ACTIVE_HIGH>;
        };
    };

    gpio@6000d000 {
		camera-trigger-high {
			status = "okay";
			gpio-hog;
			output-high;
			gpios = <CAM_TRIGGER 0>;
			label = "cam-trigger";
		};

        camera-control-output-low {
			status = "okay";
            gpio-hog;
            output-low;
            gpios = < CAM1_PWDN 0  CAM2_PWDN 0>;
            label = "cam1-pwdn", "cam2-pwdn";
        };
    };
};

// I'll readd this later on...
/// {
//    plugin-manager {
//
//        // Fragment VC_MIPI IMX296 dual sensor
//        fragement@9 {
//            ids = ">=3448-0000-300", ">=3448-0002-300";
//            override@0 {
//                target = <&{/pcie@1003000/pci@2,0}>;
//                _overlay_ {
//                    nvidia,plat-gpios = <&gpio TEGRA_GPIO(CC, 7) GPIO_ACTIVE_HIGH>;
//                };
//            };
//            override@1 {
//                target = <&sdhci2>;
//                _overlay_ {
//                    vqmmc-supply = <&max77620_ldo6>;
//                    no-sdio;
//                    no-mmc;
//                    sd-uhs-sdr104;
//                    sd-uhs-sdr50;
//                    sd-uhs-sdr25;
//                    sd-uhs-sdr12;
//                };
//            };
//            override@2 {
//                target = <&throttle_oc1>;
//                _overlay_ {
//                    nvidia,priority = <50>;
//                    nvidia,polarity-active-low = <1>;
//                    nvidia,count-threshold = <1>;
//                    nvidia,alarm-filter = <5100000>;
//                    nvidia,alarm-period = <0>;
//                    nvidia,cpu-throt-percent = <75>;
//                    nvidia,gpu-throt-level =
//                        <TEGRA_SOCTHERM_THROT_LEVEL_HIGH>;
//                };
//            };
//            override@3 {
//                target = <&{/leds}>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//
//            /* IMX296 dual sensor module */
//            override@4 {
//                target = <&imx296_vgl_cam0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@5 {
//                target = <&imx296_vgl_cam_module0>;
//                _overlay_ {
//                    status = "okay";
//                    badge = "porg_front_RBPCV2";
//                    position = "front";
//                    orientation = "1";
//                };
//            };
//            override@6 {
//                target = <&imx296_vgl_cam_module0_drivernode0>;
//                _overlay_ {
//                    status = "okay";
//                    pcl_id = "v4l2_sensor";
//                    devname = "imx296_vgl 7-001a";
//                    proc-device-tree = "/proc/device-tree/cam_i2cmux/i2c@0/rbpcv2_imx296_vgl_a@1a";
//                };
//            };
//            override@7 {
//                target = <&imx296_vgl_cam_module0_drivernode1>;
//                _overlay_ {
//                    status = "okay";
//                    pcl_id = "v4l2_lens";
//                    proc-device-tree = "/proc/device-tree/lens_imx296_vgl@RBPCV2/";
//                };
//            };
//            override@8 {
//                target = <&imx296_vgl_cam1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@9 {
//                target = <&imx296_vgl_cam_module1>;
//                _overlay_ {
//                    status = "okay";
//                    badge = "porg_rear_RBPCV2";
//                    position = "rear";
//                    orientation = "1";
//                };
//            };
//            override@10 {
//                target = <&imx296_vgl_cam_module1_drivernode0>;
//                _overlay_ {
//                    status = "okay";
//                    pcl_id = "v4l2_sensor";
//                    devname = "imx296_vgl 8-001a";
//                    proc-device-tree = "/proc/device-tree/cam_i2cmux/i2c@1/rbpcv2_imx296_vgl_e@1a";
//                };
//            };
//            override@11 {
//                target = <&imx296_vgl_cam_module1_drivernode1>;
//                _overlay_ {
//                    status = "okay";
//                    pcl_id = "v4l2_lens";
//                    proc-device-tree = "/proc/device-tree/lens_imx296_vgl@RBPCV2/";
//                };
//            };
//            /* Enable VI ports */
//            override@12 {
//                target = <&imx296_vgl_vi_base>;
//                _overlay_ {
//                    num-channels=<2>;
//                };
//            };
//            override@13 {
//                target = <&imx296_vgl_vi_port0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@14 {
//                target = <&imx296_vgl_vi_port1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@15 {
//                target = <&rbpcv2_imx296_vgl_vi_in0>;
//                _overlay_ {
//                    status = "okay";
//                    port-index = <0>;
//                    bus-width = <BUS_WIDTH>;
//                    remote-endpoint = <&rbpcv2_imx296_vgl_csi_out0>;
//                };
//            };
//            override@16 {
//                target = <&rbpcv2_imx296_vgl_vi_in1>;
//                _overlay_ {
//                    status = "okay";
//                    port-index = <4>;
//                    bus-width = <BUS_WIDTH>;
//                    remote-endpoint = <&rbpcv2_imx296_vgl_csi_out1>;
//                };
//            };
//            /* Enable CSI ports */
//            override@17 {
//                target = <&imx296_vgl_csi_base>;
//                _overlay_ {
//                    num-channels = <2>;
//                };
//            };
//            override@18 {
//                target = <&imx296_vgl_csi_chan0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@19 {
//                target = <&imx296_vgl_csi_chan0_port0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@20 {
//                target = <&rbpcv2_imx296_vgl_csi_in0>;
//                _overlay_ {
//                    status = "okay";
//                    port-index = <0>;
//                    bus-width = <BUS_WIDTH>;
//                    remote-endpoint = <&rbpcv2_imx296_vgl_out0>;
//                };
//            };
//            override@21 {
//                target = <&imx296_vgl_csi_chan0_port1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@22 {
//                target = <&rbpcv2_imx296_vgl_csi_out0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@23 {
//                target = <&imx296_vgl_csi_chan1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@24 {
//                target = <&imx296_vgl_csi_chan1_port0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@25 {
//                target = <&rbpcv2_imx296_vgl_csi_in1>;
//                _overlay_ {
//                    status = "okay";
//                    port-index = <4>;
//                    bus-width = <BUS_WIDTH>;
//                    remote-endpoint = <&rbpcv2_imx296_vgl_out1>;
//                };
//            };
//            override@26 {
//                target = <&imx296_vgl_csi_chan1_port1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@27 {
//                target = <&rbpcv2_imx296_vgl_csi_out1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            /* tegra-camera-platform settings */
//            override@28 {
//                target = <&imx296_vgl_tcp>;
//                _overlay_ {
//                    num_csi_lanes = <4>;   // ???
//                    max_lane_speed = <1500000>;
//                    min_bits_per_pixel = <10>;
//                    vi_peak_byte_per_pixel = <2>;
//                    vi_bw_margin_pct = <25>;
//                    max_pixel_rate = <240000>;
//                    isp_peak_byte_per_pixel = <5>;
//                    isp_bw_margin_pct = <25>;
//                };
//            };
//            /* gpio based i2c mux */
//            override@29 {
//                target = <&{/cam_i2cmux}>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@30 {
//                target = <&imx296_vgl_i2c_0>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//            override@31 {
//                target = <&imx296_vgl_i2c_1>;
//                _overlay_ {
//                    status = "okay";
//                };
//            };
//        };
//
//    };
//};
//